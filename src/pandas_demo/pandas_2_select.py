import pandas as pd
import numpy as np

dates = pd.date_range("20191031", periods=6)
df = pd.DataFrame(np.arange(24).reshape(6, 4), index=dates, columns=['A', 'B', 'C', 'D'])
print(df)
'''
             A   B   C   D
2019-10-31   0   1   2   3
2019-11-01   4   5   6   7
2019-11-02   8   9  10  11
2019-11-03  12  13  14  15
2019-11-04  16  17  18  19
2019-11-05  20  21  22  23
'''

#  简单数据筛选
print(df['A'])
print(df.A)
'''
2019-10-31     0
2019-11-01     4
2019-11-02     8
2019-11-03    12
2019-11-04    16
2019-11-05    20
'''

# 选择多行数据
print(df[0: 3])
print(df['2019-10-31': '2019-11-02'])
'''
            A  B   C   D
2019-10-31  0  1   2   3
2019-11-01  4  5   6   7
2019-11-02  8  9  10  11
'''

# 通过标签来筛选
print(df.loc['2019-11-01'])
'''
A    4
B    5
C    6
D    7
Name: 2019-11-01 00:00:00, dtype: int32
'''
print(df.loc[:, ['A', 'B']])
'''
             A   B
2019-10-31   0   1
2019-11-01   4   5
2019-11-02   8   9
2019-11-03  12  13
2019-11-04  16  17
2019-11-05  20  21
'''
print(df.loc['2019-11-01', ['A', 'B']])
'''
A    4
B    5
Name: 2019-11-01 00:00:00, dtype: int32
'''

# 通过序列号或者索引号来选择
print(df.iloc[3, 1])  # 13
print(df.iloc[3:5, 1:3])
'''
             B   C
2019-11-03  13  14
2019-11-04  17  18
'''
print(df.iloc[[1, 3, 5], 1:3])
'''
             B   C
2019-11-01   5   6
2019-11-03  13  14
2019-11-05  21  22
'''

# 判断指令选择
print(df[df.A > 8])
'''
             A   B   C   D
2019-11-03  12  13  14  15
2019-11-04  16  17  18  19
2019-11-05  20  21  22  23
'''
